<?phpinclude_once('../common.php');if (!$userObj->hasPermission('view-payment-report-rideshare')) {    $userObj->redirect();}$script = 'RideSharePaymentReport';if (isset($_POST['SettlePayment'])) {    $iBookingIdArr = isset($_POST['iBookingId']) ? $_POST['iBookingId'] : '';    if (!empty($iBookingIdArr)) {        $iBookingIds = implode(",", $iBookingIdArr);        $obj->sql_query("UPDATE ride_share_bookings SET ePaymentStatus = 'Settled' WHERE iBookingId IN ($iBookingIds) ");        $_SESSION['success'] = '1';        $_SESSION['var_msg'] = 'Record(s) marked as settled successfully.';        header('Location: ride_share_payment_report.php');        exit;    }}//Start Sorting$sortby = isset($_REQUEST['sortby']) ? $_REQUEST['sortby'] : 0;$order = isset($_REQUEST['order']) ? $_REQUEST['order'] : '';$iPublishedRideId = isset($_REQUEST['iPublishedRideId']) ? $_REQUEST['iPublishedRideId'] : '';$ord = ' ORDER BY pr.iPublishedRideId  DESC';//End Sorting//For Currency$sql = "select vSymbol from  currency where eDefault='Yes'";$db_currency = $obj->MySQLSelect($sql);// Start Search Parameters$option = isset($_REQUEST['option']) ? stripslashes($_REQUEST['option']) : "";$keyword = isset($_REQUEST['keyword']) ? stripslashes($_REQUEST['keyword']) : "";$searchDate = isset($_REQUEST['searchDate']) ? $_REQUEST['searchDate'] : "";$eStatus = isset($_REQUEST['eStatus']) ? $_REQUEST['eStatus'] : "";$searchRider = isset($_REQUEST['searchRider']) ? $_REQUEST['searchRider'] : '';$searchDriver = isset($_REQUEST['searchDriver']) ? $_REQUEST['searchDriver'] : '';$searchBookingNo = isset($_REQUEST['searchBookingNo']) ? $_REQUEST['searchBookingNo'] : '';$searchRideNo = isset($_REQUEST['searchRideNo']) ? $_REQUEST['searchRideNo'] : '';$searchPaymentStatus = isset($_REQUEST['searchPaymentStatus']) ? $_REQUEST['searchPaymentStatus'] : '';$startDate = isset($_REQUEST['startDate']) ? $_REQUEST['startDate'] : '';$endDate = isset($_REQUEST['endDate']) ? $_REQUEST['endDate'] : '';$endDate = isset($_REQUEST['rideShare']) ? $_REQUEST['endDate'] : '';$isRideShare = 1;$ssql = '';if ($searchRider != '') {    $ssql .= " AND rsb.iUserId = {$searchRider} ";}if ($searchDriver != '') {    $ssql .= " AND pr.iUserId = {$searchDriver} ";}if ($searchBookingNo != '') {    $ssql .= " AND rsb.vBookingNo IN ($searchBookingNo) ";}if ($searchRideNo != '') {    $ssql .= " AND pr.vPublishedRideNo = {$searchRideNo} ";}if ($searchPaymentStatus != '') {    $ssql .= " AND rsb.ePaymentStatus = '{$searchPaymentStatus}' ";}if ($startDate != '') {    $ssql .= " AND Date(pr.dStartDate) >='" . $startDate . "'";}if ($endDate != '') {    $ssql .= " AND Date(pr.dStartDate) <='" . $endDate . "'";}if (isset($iPublishedRideId) && !empty($iPublishedRideId)) {    $ssql .= " AND rsb.iPublishedRideId = " . $iPublishedRideId;}$ssql .= "AND  (rsb.eStatus = 'Approved' OR (rsb.eStatus = 'Cancelled' AND rsb.eCommissionDeduct = 'Yes') )";// End Search Parameters//Pagination Start$per_page = $DISPLAY_RECORD_NUMBER; // number of results to show per page$sql = "SELECT COUNT(iBookingId) AS Total FROM ride_share_bookings rsb  JOIN published_rides pr ON (pr.iPublishedRideId = rsb.iPublishedRideId) WHERE 1 =1 $ssql ";$totalData = $obj->MySQLSelect($sql);$total_results = $totalData[0]['Total'];$total_pages = ceil($total_results / $per_page); //total pages we going to have$show_page = 1;//-------------if page is setcheck------------------//$start = 0;$end = $per_page;if (isset($_GET['page'])) {    $show_page = $_GET['page'];             //it will telles the current page    if ($show_page > 0 && $show_page <= $total_pages) {        $start = ($show_page - 1) * $per_page;        $end = $start + $per_page;    }}// display pagination$page = isset($_GET['page']) ? intval($_GET['page']) : 0;$tpages = $total_pages;if ($page <= 0) $page = 1;//Pagination End$sql = "SELECT  CONCAT(riderDriver.vName,' ',riderDriver.vLastName) AS driver_Name,  CONCAT(riderUser.vName,' ',riderUser.vLastName) AS  rider_Name,                 riderUser.vImgName as rider_ProfileImg, riderUser.iUserId as rider_iUserId, riderDriver.iUserId as driver_iUserId,                pr.vPublishedRideNo,pr.tStartLocation,pr.tStartLat,pr.tStartLong,pr.tEndLocation,pr.tEndLat,pr.tEndLong,pr.dStartDate,pr.dStartDate,pr.dEndDate,pr.tPriceRatio,                pr.tEndCity,pr.tStartCity,rsb.vBookingNo,rsb.dBookingDate,                rsb.iPublishedRideId,rsb.eStatus,rsb.fTotal,rsb.iBookedSeats,pr.tDriverDetails,rsb.iBookingId,rsb.iCancelReasonId,rsb.tCancelReason, rsb.iBookingId , rsb.fBookingFee, rsb.ePaymentOption, rsb.ePaymentStatus                FROM ride_share_bookings rsb                 JOIN published_rides pr ON (pr.iPublishedRideId = rsb.iPublishedRideId)                JOIN register_user riderUser  ON (riderUser.iUserId = rsb.iUserId)                JOIN register_user riderDriver  ON (riderDriver.iUserId = pr.iUserId)  WHERE 1=1   $ssql $ord LIMIT $start, $per_page";$data_drv = $obj->MySQLSelect($sql);$iBookingId = array_column($data_drv, 'iBookingId');$bookingData = $RIDE_SHARE_OBJ->getCommission($iBookingId, $ssql);$bookingDataTotal = $RIDE_SHARE_OBJ->getTotalFare($iBookingId, $ssql);$endRecord = count($data_drv);$var_filter = "";foreach ($_REQUEST as $key => $val) {    if ($key != "tpages" && $key != 'page') $var_filter .= "&$key=" . stripslashes($val);}$reload = $_SERVER['PHP_SELF'] . "?tpages=" . $tpages . $var_filter;$langLabels = $langage_lbl_admin;$Today = Date('Y-m-d');$tdate = date("d") - 1;$mdate = date("d");$Yesterday = date("Y-m-d", mktime(0, 0, 0, date("m"), date("d") - 1, date("Y")));$curryearFDate = date("Y-m-d", mktime(0, 0, 0, '1', '1', date("Y")));$curryearTDate = date("Y-m-d", mktime(0, 0, 0, "12", "31", date("Y")));$prevyearFDate = date("Y-m-d", mktime(0, 0, 0, '1', '1', date("Y") - 1));$prevyearTDate = date("Y-m-d", mktime(0, 0, 0, "12", "31", date("Y") - 1));$currmonthFDate = date("Y-m-d", mktime(0, 0, 0, date("m"), date("d") - $tdate, date("Y")));$currmonthTDate = date("Y-m-d", mktime(0, 0, 0, date("m") + 1, date("d") - $mdate, date("Y")));$prevmonthFDate = date("Y-m-d", mktime(0, 0, 0, date("m") - 1, date("d") - $tdate, date("Y")));$prevmonthTDate = date("Y-m-d", mktime(0, 0, 0, date("m"), date("d") - $mdate, date("Y")));$monday = date('Y-m-d', strtotime('monday this week'));$sunday = date('Y-m-d', strtotime('sunday this week'));$Pmonday = date('Y-m-d', strtotime('monday this week -1 week'));$Psunday = date('Y-m-d', strtotime('sunday this week -1 week'));?><!DOCTYPE html><html lang="en"><!-- BEGIN HEAD--><head>    <meta charset="UTF-8"/>    <title><?= $SITE_NAME ?> | Published Rides</title>    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>    <?php include_once('global_files.php'); ?>    <link rel="stylesheet" href="../assets/css/modal_alert.css"/>    <style type="text/css">        .setteled-class {            background-color: #bddac5;        }        .form-group .row {            padding-bottom: 0;        }    </style></head><!-- END  HEAD--><!-- BEGIN BODY--><body class="padTop53 "><!-- Main LOading --><!-- MAIN WRAPPER --><div id="wrap">    <?php include_once('header.php'); ?>    <?php include_once('left_menu.php'); ?>    <!--PAGE CONTENT -->    <div id="content">        <div class="inner">            <div id="add-hide-show-div">                <div class="row">                    <div class="col-lg-12">                        <h2>Payment Report</h2>                    </div>                </div>                <hr/>            </div>            <?php include('valid_msg.php'); ?>            <form name="frmsearch" id="frmsearch" action="javascript:void(0);" method="post">                <div class="Posted-date mytrip-page">                    <input type="hidden" name="action" value="search"/>                    <input type="hidden" name="rideShare" id="rideShare" value="1"/>                    <h3>Search ...</h3>                    <span>                            <a style="cursor:pointer"                               onClick="return todayDate('dp4', 'dp5');"><?= $langage_lbl_admin['LBL_MYTRIP_Today']; ?></a>                            <a style="cursor:pointer"                               onClick="return yesterdayDate('dFDate', 'dTDate');"><?= $langage_lbl_admin['LBL_MYTRIP_Yesterday']; ?></a>                            <a style="cursor:pointer"                               onClick="return currentweekDate('dFDate', 'dTDate');"><?= $langage_lbl_admin['LBL_MYTRIP_Current_Week']; ?></a>                            <a style="cursor:pointer"                               onClick="return previousweekDate('dFDate', 'dTDate');"><?= $langage_lbl_admin['LBL_MYTRIP_Previous_Week']; ?></a>                            <a style="cursor:pointer"                               onClick="return currentmonthDate('dFDate', 'dTDate');"><?= $langage_lbl_admin['LBL_MYTRIP_Current_Month']; ?></a>                            <a style="cursor:pointer"                               onClick="return previousmonthDate('dFDate', 'dTDate');"><?= $langage_lbl_admin['LBL_MYTRIP_Previous Month']; ?></a>                            <a style="cursor:pointer"                               onClick="return currentyearDate('dFDate', 'dTDate');"><?= $langage_lbl_admin['LBL_MYTRIP_Current_Year']; ?></a>                            <a style="cursor:pointer"                               onClick="return previousyearDate('dFDate', 'dTDate');"><?= $langage_lbl_admin['LBL_MYTRIP_Previous_Year']; ?></a>                        </span>                </div>                <div class="form-group">                    <div class="row">                        <div class="col-lg-3">                            <input type="text" id="dp4" name="startDate" placeholder="From Date" class="form-control"                                   value="" readonly="" style="cursor:default; background-color: #fff"/>                        </div>                        <div class="col-lg-3">                            <input type="text" id="dp5" name="endDate" placeholder="To Date" class="form-control"                                   value="" readonly="" style="cursor:default; background-color: #fff"/>                        </div>                        <div class="col-lg-3">                            <select class="form-control filter-by-text" name='searchRider'                                    data-text="Booked By(Select User)" id="searchRider">                                <option value="">Booked By(Select User)</option>                            </select>                        </div>                        <div class="col-lg-3">                            <input type="text" class="form-control" name="searchBookingNo" id="searchBookingNo"                                   value="<?= $searchBookingNo ?>" placeholder="Booking No.">                        </div>                    </div>                </div>                <div class="row">                    <div class="col-lg-3">                        <input type="text" class="form-control" name="searchRideNo" id="searchRideNo"                               value="<?= $searchRideNo ?>" placeholder="Ride No.">                    </div>                    <div class="col-lg-3">                        <select class="form-control filter-by-text" name="searchPaymentStatus"                                data-text="Select Payment Status" id="searchPaymentStatus">                            <option value="" <?= empty($searchPaymentStatus) ? "selected" : "" ?>>Select Payment                                Status                            </option>                            <option value="Settled" <?= $searchPaymentStatus == "Settled" ? "selected" : "" ?>>Settled                            </option>                            <option value="Unsettled" <?= $searchPaymentStatus == "Unsettled" ? "selected" : "" ?>>                                Unsettled                            </option>                        </select>                    </div>                </div>                <div class="tripBtns001">                    <b>                        <input type="submit" value="Search" class="btnalt button11" id="Search" name="Search"                               title="Search"/>                        <input type="button" value="Reset" class="btnalt button11"                               onClick="window.location.href = 'ride_share_payment_report.php'"/>                        <?php if (!empty($data_drv)) {  ?>                            <button type="button" onClick="reportExportTypes('RideSharePaymentReport')" class="export-btn001" style="float:none;">Export                            </button>                        <?php } ?>                    </b>                </div>            </form>            <div class="table-list">                <div class="row">                    <div class="col-lg-12">                        <div style="clear:both;"></div>                        <div class="table-responsive">                            <form class="_list_form" id="_list_form" method="post"                                  action="<?php echo $_SERVER['PHP_SELF'] ?>">                                <input type="hidden" name="SettlePayment" value="Yes">                                <table class="table table-bordered">                                    <thead>                                    <tr>                                        <th>Booking No.</th>                                        <th>Ride No.</th>                                        <th>Published By/Booked By</th>                                        <th>Booking Date</th>                                        <th style="width: 15%">Ride Start & End Time</th>                                        <?php /*<th>Start Location & End Location</th>*/ ?>                                        <th style="text-align: center">Booked Seats</th>                                        <th style="text-align: right">Booking Fee / Site Earning</th>                                        <th width="10%" style="text-align: right">Total</th>                                        <th>Publisher payout / take amount Payment</th>                                        <th>Payment Method</th>                                        <th>Status</th>                                        <th>Settle</th>                                    </tr>                                    </thead>                                    <tbody>                                    <?php                                    if (!empty($data_drv)) {                                        for ($i = 0; $i < count($data_drv); $i++) {                                            $time = $RIDE_SHARE_OBJ->convertSecToMin(floor($data_drv[$i]['fDuration']));                                            $class_setteled = "";                                            if ($data_drv[$i]['ePaymentStatus'] == "Settled") {                                                $class_setteled = "setteled-class";                                            }                                            $set_unsetarray[] = $data_drv[$i]['ePaymentStatus'];                                            $driverAmount = $data_drv[$i]['fTotal'] - $data_drv[$i]['fBookingFee'];                                            if ($data_drv[$i]['ePaymentOption'] == "Cash") {                                                $driverAmount = $driverAmount - $data_drv[$i]['fTotal'];                                            }                                            ?>                                            <tr class="gradeA <?= $class_setteled ?>">                                                <td><?= $data_drv[$i]['vBookingNo']; ?></td>                                                <td><?= $data_drv[$i]['vPublishedRideNo']; ?></td>                                                <td> <b>Published By</b>: <?php if ($userObj->hasPermission('view-users')) { ?><a href="javascript:void(0);" onClick="show_driver_details('<?= $data_drv[$i]['driver_iUserId']; ?>')" style="text-decoration: underline;"><?php } ?><?= clearName($data_drv[$i]['driver_Name']); ?><?php if ($userObj->hasPermission('view-users')) { ?></a><?php } ?>                                                <br>                                                 <b>Booked By</b>: <?php if ($userObj->hasPermission('view-users')) { ?><a href="javascript:void(0);" onClick="show_rider_details('<?= $data_drv[$i]['rider_iUserId']; ?>')" style="text-decoration: underline;"><?php } ?><?= clearName($data_drv[$i]['rider_Name']); ?><?php if ($userObj->hasPermission('view-users')) { ?></a><?php } ?>                                                </td>                                                                                                                                                 <td width="10%" align="center"><?= date('M d, Y  h:i A', strtotime($data_drv[$i]['dBookingDate'])); ?></td>                                                <td>                                                    <div class="lableCombineData">                                                        <label>Start Time</label>                                                        <br>                                                        <span><?= date('M d, Y  h:i A', strtotime($data_drv[$i]['dStartDate'])); ?> </span>                                                        <br>                                                        <label>End Time</label>                                                        <br>                                                        <span><?= date('M d, Y  h:i A', strtotime($data_drv[$i]['dEndDate'])); ?></span>                                                    </div>                                                </td>                                                <?php /*<td>                                                    <div class="lableCombineData">                                                        <label>Start Location</label>                                                        <br>                                                        <span><?= $data_drv[$i]['tStartLocation']; ?> </span>                                                        <br>                                                        <label>End Location</label>                                                        <br>                                                        <span>  <?= $data_drv[$i]['tEndLocation']; ?></span>                                                    </div>                                                </td>*/ ?>                                                <td style="text-align: center"><?= $data_drv[$i]['iBookedSeats']; ?></td>                                                <td style="text-align: right">                                                    <?php echo formateNumAsPerCurrency($data_drv[$i]['fBookingFee'], ''); ?>                                                </td>                                                <td style="text-align: right">                                                    <?php                                                        echo formateNumAsPerCurrency($data_drv[$i]['fTotal'], '');                                                   ?>                                                </td>                                                <td style="text-align: right">                                                   <?php if ($data_drv[$i]['eStatus'] == 'Cancelled') {                                                    echo "--";                                                    } else {?>                                                    <a href="javascript:void(0);"                                                       data-total="<?= formateNumAsPerCurrency($data_drv[$i]['fTotal'], '') ?>"                                                       data-bookingfee="<?= formateNumAsPerCurrency($data_drv[$i]['fBookingFee'], '') ?>"                                                       data-paymentoption="<?= $data_drv[$i]['ePaymentOption'] ?>"                                                       data-bookingno="<?= $data_drv[$i]['vBookingNo'] ?>"                                                       data-driveramount="<?= formateNumAsPerCurrency($driverAmount, '') ?>"                                                       style="text-decoration: underline;"                                                       onclick="showDriverPaymentDetails(this)">                                                        <?php echo formateNumAsPerCurrency($driverAmount, ''); ?>                                                    </a>                                                <?php } ?>                                                </td>                                                <td><?= $data_drv[$i]['ePaymentOption'] ?></td>                                                <td><?= $data_drv[$i]['eStatus'] ?><?php if ($data_drv[$i]['eStatus'] == 'Cancelled') { ?> (Refunded) <?php } ?></td>                                                <td style="text-align: center">                                                    <?php if ($data_drv[$i]['ePaymentStatus'] == "Unsettled") { ?>                                                        <input class="validate[required]" type="checkbox"                                                               value="<?= $data_drv[$i]['iBookingId'] ?>"                                                               id="iBookingId_<?= $data_drv[$i]['iBookingId'] ?>"                                                               name="iBookingId[]">                                                    <?php } else { ?>                                                        --                                                    <?php } ?>                                                </td>                                            </tr>                                        <?php } ?>                                        <tr class="gradeA">                                            <td>                                                <strong>Total</strong>                                            </td>                                            <td>--</td>                                            <td>--</td>                                            <td>--</td>                                            <td>--</td>                                            <td style="text-align: center">--</td>                                            <td style="text-align: right"><?= formateNumAsPerCurrency($bookingData['commission'], ''); ?></td>                                            <td style="text-align: right"><?= formateNumAsPerCurrency($bookingDataTotal, ''); ?></td>                                            <td style="text-align: right">--</td>                                            <td>--</td>                                            <td style="text-align: center;">                                                <?php if (in_array("Unsettled", $set_unsetarray)) { ?>                                                    <span>                                                        <a onclick="SettlePayment()" href="javascript:void(0);"><button                                                                    class="btn btn-primary" type="button">Mark As Settled</button></a>                                                    </span>                                                <?php } else { ?>                                                    --                                                <?php } ?>                                            </td>                                        </tr>                                        <?php                                    } else {                                        ?>                                        <tr class="gradeA">                                            <td colspan="7"> No Records Found.</td>                                        </tr>                                    <?php } ?>                                    </tbody>                                </table>                            </form>                            <?php include('pagination_n.php'); ?>                        </div>                    </div> <!--TABLE-END-->                </div>            </div>            <div class="modal fade" id="fare_details_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"                 aria-hidden="true">                <div class="modal-dialog">                    <div class="modal-content">                        <div class="modal-header">                            <h4>                                <i style="margin:2px 5px 0 2px;">                                    <img src="images/icon/driver-icon.png" alt="">                                </i>                                <span id="BookingNo"></span>                                <button type="button" class="close" data-dismiss="modal">x</button>                            </h4>                        </div>                        <div class="modal-body" style="max-height: 450px;overflow: auto;">                            <div id="faredata"></div>                        </div>                    </div>                </div>            </div>        </div>    </div>    <!--END PAGE CONTENT --></div><!--END MAIN WRAPPER --><form name="pageForm" id="pageForm" action="action" method="post">    <input type="hidden" name="page" id="page" value="<?php echo $page; ?>">    <input type="hidden" name="tpages" id="tpages" value="<?php echo $tpages; ?>">    <input type="hidden" name="iGiftCardId" id="iMainId01" value="">    <input type="hidden" name="status" id="status01" value="">    <input type="hidden" name="statusVal" id="statusVal" value="">    <input type="hidden" name="option" value="<?php echo $option; ?>">    <input type="hidden" name="keyword" value="<?php echo $keyword; ?>">    <input type="hidden" name="sortby" id="sortby" value="<?php echo $sortby; ?>">    <input type="hidden" name="order" id="order" value="<?php echo $order; ?>">    <input type="hidden" name="method" id="method" value="">    <input type="hidden" name="searchRider" value="<?= $searchRider; ?>">    <input type="hidden" name="searchDriver" value="<?= $searchDriver; ?>">    <input type="hidden" name="searchPaymentStatus" value="<?= $searchPaymentStatus; ?>">    <input type="hidden" name="startDate" value="<?= $startDate; ?>">    <input type="hidden" name="endDate" value="<?= $endDate; ?>"></form><div class="modal fade " id="detail_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">    <div class="modal-dialog">        <div class="modal-content">            <div class="modal-header">                <h4><i style="margin:2px 5px 0 2px;"><img src="images/rider-icon.png" alt=""></i><?= $langage_lbl_admin['LBL_RIDER']; ?> Details<button type="button" class="close" data-dismiss="modal">x</button>                </h4>            </div>            <div class="modal-body" style="max-height: 450px;overflow: auto;">                <div id="imageIcons">                    <div align="center">                        <img src="default.gif"><br/>                        <span>Retrieving details,please Wait...</span>                    </div>                </div>                <div id="rider_detail"></div>            </div>        </div>    </div></div><div class="modal fade " id="driver_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">    <div class="modal-dialog">        <div class="modal-content">            <div class="modal-header">                <h4><i style="margin:2px 5px 0 2px;"><img src="images/rider-icon.png" alt=""></i><?= $langage_lbl_admin['LBL_DRIVER']; ?> Details<button type="button" class="close" data-dismiss="modal">x</button>                </h4>            </div>            <div class="modal-body" style="max-height: 450px;overflow: auto;">                <div id="driver_imageIcons">                    <div align="center">                        <img src="default.gif"><br/>                        <span>Retrieving details,please Wait...</span>                    </div>                </div>                <div id="driver_detail"></div>            </div>        </div>    </div></div><?phpinclude_once('footer.php');include_once('searchfunctions.php');?><script src="../assets/js/modal_alert.js"></script><link rel="stylesheet" href="../assets/plugins/datepicker/css/datepicker.css"/><script src="../assets/plugins/datepicker/js/bootstrap-datepicker.js"></script><script>    var startDate;    var endDate;    $('#dp4').datepicker()        .on('changeDate', function (ev) {            startDate = new Date(ev.date);            if (endDate != null) {                if (ev.date.valueOf() < endDate.valueOf()) {                    $('#alert').show().find('strong').text('The start date can not be greater then the end date');                } else {                    $('#alert').hide();                    $('#startDate').text($('#dp4').data('date'));                }            }            $('#dp4').datepicker('hide');        });    $('#dp5').datepicker()        .on('changeDate', function (ev) {            endDate = new Date(ev.date);            if (startDate != null) {                if (ev.date.valueOf() < startDate.valueOf()) {                    $('#alert').show().find('strong').text('The end date can not be less then the start date');                } else {                    $('#alert').hide();                    $('#endDate').text($('#dp5').data('date'));                }            }            $('#dp5').datepicker('hide');        });    $(document).ready(function () {        if ('<?= $startDate ?>' != '') {            $("#dp4").val('<?= $startDate ?>');            $("#dp4").datepicker('update', '<?= $startDate ?>');        }        if ('<?= $endDate ?>' != '') {            $("#dp5").datepicker('update', '<?= $endDate; ?>');            $("#dp5").val('<?= $endDate; ?>');        }    });    function todayDate() {        $("#dp4").val('<?= $Today; ?>');        $("#dp5").val('<?= $Today; ?>');    }    function reset() {        location.reload();    }    function yesterdayDate() {        $("#dp4").val('<?= $Yesterday; ?>');        $("#dp4").datepicker('update', '<?= $Yesterday; ?>');        $("#dp5").datepicker('update', '<?= $Yesterday; ?>');        $("#dp4").change();        $("#dp5").change();        $("#dp5").val('<?= $Yesterday; ?>');    }    function currentweekDate(dt, df) {        $("#dp4").val('<?= $monday; ?>');        $("#dp4").datepicker('update', '<?= $monday; ?>');        $("#dp5").datepicker('update', '<?= $sunday; ?>');        $("#dp5").val('<?= $sunday; ?>');    }    function previousweekDate(dt, df) {        $("#dp4").val('<?= $Pmonday; ?>');        $("#dp4").datepicker('update', '<?= $Pmonday; ?>');        $("#dp5").datepicker('update', '<?= $Psunday; ?>');        $("#dp5").val('<?= $Psunday; ?>');    }    function currentmonthDate(dt, df) {        $("#dp4").val('<?= $currmonthFDate; ?>');        $("#dp4").datepicker('update', '<?= $currmonthFDate; ?>');        $("#dp5").datepicker('update', '<?= $currmonthTDate; ?>');        $("#dp5").val('<?= $currmonthTDate; ?>');    }    function previousmonthDate(dt, df) {        $("#dp4").val('<?= $prevmonthFDate; ?>');        $("#dp4").datepicker('update', '<?= $prevmonthFDate; ?>');        $("#dp5").datepicker('update', '<?= $prevmonthTDate; ?>');        $("#dp5").val('<?= $prevmonthTDate; ?>');    }    function currentyearDate(dt, df) {        $("#dp4").val('<?= $curryearFDate; ?>');        $("#dp4").datepicker('update', '<?= $curryearFDate; ?>');        $("#dp5").datepicker('update', '<?= $curryearTDate; ?>');        $("#dp5").val('<?= $curryearTDate; ?>');    }    function previousyearDate(dt, df) {        $("#dp4").val('<?= $prevyearFDate; ?>');        $("#dp4").datepicker('update', '<?= $prevyearFDate; ?>');        $("#dp5").datepicker('update', '<?= $prevyearTDate; ?>');        $("#dp5").val('<?= $prevyearTDate; ?>');    }    $("#setAllCheck").on('click', function () {        if ($(this).prop("checked")) {            jQuery("#_list_form input[type=checkbox]").each(function () {                if ($(this).attr('disabled') != 'disabled') {                    this.checked = 'true';                }            });        } else {            jQuery("#_list_form input[type=checkbox]").each(function () {                this.checked = '';            });        }    });    $("#Search").on('click', function () {        var action = $("#_list_form").attr('action');        var formValus = $("#frmsearch").serialize();        window.location.href = action + "?" + formValus;    });    $('.entypo-export').click(function (e) {        e.stopPropagation();        var $this = $(this).parent().find('div');        $(".openHoverAction-class div").not($this).removeClass('active');        $this.toggleClass('active');    });    $(document).on("click", function (e) {        if ($(e.target).is(".openHoverAction-class,.show-moreOptions,.entypo-export") === false) {            $(".show-moreOptions").removeClass("active");        }    });     function show_driver_details(userid) {            $("#driver_detail").html('');            $("#driver_imageIcons").show();            $("#driver_modal").modal('show');            if (userid != "") {                 var ajaxData = {                    'URL': '<?= $tconfig['tsite_url_main_admin'] ?>ajax_rider_details.php',                    'AJAX_DATA': "iUserId=" + userid,                    'REQUEST_DATA_TYPE': 'html'                };                getDataFromAjaxCall(ajaxData, function (response) {                    if (response.action == "1") {                        var data = response.result;                        $("#driver_detail").html(data);                        $("#driver_imageIcons").hide();                    } else {                        console.log(response.result);                        $("#driver_modal").modal('hide');                    }                });            }        }    function showDriverPaymentDetails(elem) {        var driveramount = $(elem).attr("data-driveramount");        var total = $(elem).attr("data-total");        var bookingfee = $(elem).attr("data-bookingfee");        var bookingno = $(elem).attr("data-bookingno");        var paymentoption = $(elem).attr("data-paymentoption");        var fareHtml = '<table style="width:100%" cellpadding="5" cellspacing="0" border="0"><tbody>';        fareHtml += '<tr><td><b>Description</b></td><td align="right"><b>Amount</b></td></tr>';        fareHtml += '<tr><td colspan="2"><div style="border-top:1px dashed #d1d1d1"></div></td></tr>';        fareHtml += '<tr><td>Total Fare</td><td align="right">' + total + '</td></tr>';        fareHtml += '<tr><td>Booking Fees</td><td align="right">' + '-' + bookingfee + '</td></tr>';        if (paymentoption == "Cash") {            fareHtml += '<tr><td>Cash Received</td><td align="right">' + '-' + total + '</td></tr>';        }        fareHtml += '<tr><td colspan="2"><div style="border-top:1px dashed #d1d1d1"></div></td></tr>';        fareHtml += '<tr><td><b><?= $langage_lbl_admin['LBL_DRIVER_TXT_ADMIN']; ?> Pay / Take Amount</b></td><td align="right"><b>' + driveramount + '</b></td></tr>';        $("#faredata").html("");        $("#BookingNo").text("Driver Pay / Take Amount Breakdown - #" + bookingno);        $("#faredata").html(fareHtml);        $("#fare_details_modal").modal('show');    }    function SettlePayment() {        $('#_list_form').submit();    }</script></body><!-- END BODY--></html>